---
import { actions } from "astro:actions";
import { db, Idea } from "astro:db";
import Layout from "../layouts/default.astro";
import IdeaList from "../components/idea-list.astro";

export const prerender: boolean = false;

interface Idea {
	id: number;
	text: string;
	good: boolean;
}

const headTitle: string = "Ideas ðŸ’¡";
const pageTitle: string = "ðŸ’¡ I'm The Idea Guy, Bay-bee!! ðŸ’¡";

const ideas: Idea[] = await db.select().from(Idea);
---

<Layout headTitle={headTitle} pageTitle={pageTitle}>
	<h1>{pageTitle}</h1>

	<section class="idea-form box">
		<form action="/ideas" method="POST" action={actions.ideas.save}>
			<label for="text">
				<h3>Idea:</h3>
				<input type="text" id="text" name="text" required />
			</label>

			<fieldset>
				<legend><h3>Is this Idea Any Good?</h3></legend>
				<label for="yes">
					<input type="radio" id="yes" name="good" value="true" />
					Yes
				</label>
				<label for="no">
					<input type="radio" id="no" name="good" value="false" />
					No
				</label>
			</fieldset>
			<button type="submit">Add Idea</button>
		</form>
	</section>

	<section class="ideas-lists flex">
		<IdeaList title="Good Ideas ðŸ’¡" ideas={ideas.filter((idea) => idea.good)} />
		<IdeaList title="Bad Ideas ðŸ’©" ideas={ideas.filter((idea) => !idea.good)} />
	</section>
</Layout>
